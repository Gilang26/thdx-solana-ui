<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>THDX ‚Ä¢ Solana Lite UI v2</title>
  <style>
    body{background:#0b1220;color:#e6edf3;font-family:system-ui,Arial,sans-serif;margin:0;display:grid;place-items:center;height:100vh}
    .card{background:#121a2a;border:1px solid #22304a;border-radius:12px;padding:24px;width:min(420px,90vw);text-align:center}
    input,button{width:100%;padding:12px;border-radius:10px;border:0;font-size:15px;margin-top:8px}
    button{cursor:pointer;font-weight:700;transition:.2s}
    #connect{background:linear-gradient(90deg,#7c5cff,#6ee7ff)}
    #send{background:linear-gradient(90deg,#22c55e,#15803d)}
    pre{white-space:pre-wrap;background:#0f1625;border:1px solid #22304a;border-radius:10px;padding:10px;text-align:left;font-size:13px;margin-top:10px}
  </style>
</head>
<body>
  <div class="card">
    <h2>üí† THDX ‚Ä¢ Solana Lite UI v2</h2>
    <p>Transfer SOL via signTransaction API (tanpa web3.js)</p>
    <button id="connect">üîå Connect Wallet</button>
    <input id="receiver" placeholder="Alamat penerima (contoh: 6a8XJs...)" />
    <input id="amount" type="number" placeholder="Jumlah SOL (contoh: 0.01)" />
    <button id="send" disabled>üöÄ Kirim</button>
    <pre id="log">Log siap...</pre>
  </div>

  <script>
    const log = (m)=>{
      const el=document.getElementById("log");
      el.textContent+="\n"+m;
      el.scrollTop=el.scrollHeight;
      console.log(m);
    };

    let provider=null;
    let pubkey=null;

    async function connectWallet(){
      try{
        if(window.solana && window.solana.isPhantom){
          provider=window.solana;
          const resp=await provider.connect();
          pubkey=resp.publicKey.toString();
          log("‚úÖ Connected (Phantom): "+pubkey);
          document.getElementById("send").disabled=false;
        }else if(window.okxwallet && window.okxwallet.solana){
          provider=window.okxwallet.solana;
          const resp=await provider.connect();
          pubkey=resp.publicKey.toString();
          log("‚úÖ Connected (OKX): "+pubkey);
          document.getElementById("send").disabled=false;
        }else{
          log("‚ùå Wallet tidak ditemukan. Gunakan browser Phantom / OKX / Trust.");
        }
      }catch(e){
        log("‚ùå Connect error: "+(e.message||e));
      }
    }

    async function sendSol(){
      try{
        if(!provider||!pubkey) return log("‚ö†Ô∏è Hubungkan wallet dulu.");
        const to=document.getElementById("receiver").value.trim();
        const amount=parseFloat(document.getElementById("amount").value);
        if(!to||isNaN(amount)) return log("‚ö†Ô∏è Isi alamat penerima & jumlah.");

        log("üßæ Menyiapkan transaksi...");

        // Buat raw transaction di wallet (provider buatkan sendiri)
        const txData = {
          recipient: to,
          amount: amount,
          network: "mainnet-beta"
        };

        const tx = await provider.request({
          method: "solana_signAndSendTransaction",
          params: [txData],
        });

        log("üöÄ TX terkirim!");
        log("üîó Signature: "+tx);
      }catch(e){
        log("‚ùå Error: "+(e.message||JSON.stringify(e)));
      }
    }

    document.getElementById("connect").onclick=connectWallet;
    document.getElementById("send").onclick=sendSol;
  </script>
</body>
</html>
